<!DOCTYPE html>
<html>
<head>
    <title>Checkout - HomeStock Express</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f0f8ff;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .payment-box {
            border: 3px solid #2563eb;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            background: #f0f7ff;
        }
        button {
            background: #10b981;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
        }
        button:hover {
            background: #0da271;
        }
        input, textarea, select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .warning-box {
            background: #fff3cd;
            border-left: 6px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
        }
        .order-summary {
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid #2563eb;
        }
        .whatsapp-note {
            background: #25D366;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè† HomeStock Express - Checkout</h1>
        
        <!-- WARNING BOX - PAYMENT FIRST -->
        <div class="warning-box">
            <h3>‚ö†Ô∏è PAYMENT REQUIRED BEFORE DELIVERY</h3>
            <p><strong>You must pay FIRST. We deliver AFTER payment confirmation.</strong></p>
            <p>1. Complete this form<br>
               2. Send payment to our numbers<br>
               3. We confirm payment on our phone<br>
               4. We deliver to you</p>
        </div>
        
        <!-- Order Summary -->
        <div class="order-summary">
            <h3>Your Order Summary:</h3>
            <div id="order-items">Loading your items...</div>
            <p style="font-size: 24px; color: #2563eb;"><strong>Total Amount: $<span id="order-total">0.00</span></strong></p>
        </div>
        
        <!-- Payment Options -->
        <h2>üí≥ Choose Payment Method</h2>
        
        <div class="payment-box">
            <h3>üì± MPesa</h3>
            <p><strong>Send to:</strong> <span style="color: #2563eb; font-size: 18px;">0708592532</span></p>
            <p><strong>Business Name:</strong> HomeStock Express</p>
            <p><em>Include order number in reference</em></p>
        </div>
        
        <div class="payment-box">
            <h3>üì± Airtel Money</h3>
            <p><strong>Send to:</strong> <span style="color: #2563eb; font-size: 18px;">0789503762</span></p>
            <p><strong>Business Name:</strong> HomeStock Express</p>
            <p><em>Include order number in reference</em></p>
        </div>
        
        <div class="payment-box">
            <h3>üí≥ PayPal</h3>
            <p><strong>Send to:</strong> paypal.me/homestockexpress</p>
            <p><em>Include order details in note</em></p>
        </div>
        
        <!-- WhatsApp Note -->
        <div class="whatsapp-note">
            <p><strong>üì± WhatsApp Payment Proof:</strong> Send screenshot to +254708592532 after payment</p>
        </div>
        
        <!-- Delivery Form -->
        <h2>üöö Delivery Details</h2>
        
        <label>Your Full Name:</label>
        <input type="text" id="customer-name" placeholder="John Doe" required>
        
        <label>Your Phone Number:</label>
        <input type="tel" id="customer-phone" placeholder="07XX XXX XXX" required>
        
        <label>Delivery Address (Full):</label>
        <textarea id="customer-address" placeholder="Street, Building, Apartment, City, Area" rows="3" required></textarea>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <div>
                <label>Delivery Date:</label>
                <input type="date" id="delivery-date" required>
            </div>
            <div>
                <label>Preferred Time:</label>
                <select id="delivery-time" required>
                    <option value="9-12">9:00 AM - 12:00 PM</option>
                    <option value="12-3">12:00 PM - 3:00 PM</option>
                    <option value="3-6">3:00 PM - 6:00 PM</option>
                    <option value="6-9">6:00 PM - 9:00 PM</option>
                </select>
            </div>
        </div>
        
        <!-- Additional Notes -->
        <div style="margin: 20px 0;">
            <label>Special Instructions (Optional):</label>
            <textarea id="special-notes" placeholder="Gate code, building instructions, leave at door, etc." rows="2"></textarea>
        </div>
        
        <!-- Terms -->
        <div style="margin: 20px 0; padding: 15px; background: #f1f5f9; border-radius: 5px;">
            <p><input type="checkbox" id="agree-terms" required>
            <label for="agree-terms"><strong>I agree:</strong> Payment must be sent FIRST. Delivery will only happen after payment confirmation. All sales are final - no returns or refunds.</label></p>
        </div>
        
        <!-- Submit Button -->
        <button onclick="placeOrder()">‚úÖ SUBMIT ORDER & GET PAYMENT INSTRUCTIONS</button>
        
        <p style="text-align: center; margin-top: 30px;">
            <a href="index.html" style="color: #2563eb; text-decoration: none; font-weight: bold;">‚Üê Back to Shopping</a>
        </p>
        
        <!-- Contact Info -->
        <div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd;">
            <p><strong>üìû Need Help?</strong><br>
            Call/Text: 0708592532<br>
            WhatsApp: +254708592532<br>
            Email: deliverwhisk@gmail.com</p>
        </div>
    </div>

    <script>
        // When page loads, show cart items
        window.onload = function() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const total = localStorage.getItem('total') || '0.00';
            
            const itemsDiv = document.getElementById('order-items');
            const totalSpan = document.getElementById('order-total');
            
            // Clear loading message
            itemsDiv.innerHTML = '';
            
            // Show each item
            if (cart.length === 0) {
                itemsDiv.innerHTML = '<p style="color: #666;">Your cart is empty! <a href="index.html">Go back to shop</a></p>';
            } else {
                cart.forEach(item => {
                    const p = document.createElement('p');
                    p.textContent = `‚Ä¢ ${item.name} - $${item.price}`;
                    itemsDiv.appendChild(p);
                });
            }
            
            // Show total
            totalSpan.textContent = total;
            
            // Set today as minimum date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('delivery-date').min = today;
            
            // Set default date to tomorrow
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            document.getElementById('delivery-date').value = tomorrow.toISOString().split('T')[0];
        };
        
        function placeOrder() {
            // Get all values
            const name = document.getElementById('customer-name').value.trim();
            const phone = document.getElementById('customer-phone').value.trim();
            const address = document.getElementById('customer-address').value.trim();
            const date = document.getElementById('delivery-date').value;
            const time = document.getElementById('delivery-time').value;
            const notes = document.getElementById('special-notes').value.trim();
            const agree = document.getElementById('agree-terms').checked;
            
            // Get cart info
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const total = localStorage.getItem('total') || '0.00';
            
            // Validate
            if (!name || !phone || !address || !date || !agree) {
                alert('Please fill ALL required fields and agree to terms!');
                return;
            }
            
            if (cart.length === 0) {
                alert('Your cart is empty! Go back and add items.');
                return;
            }
            
            if (phone.length < 10) {
                alert('Please enter a valid phone number (10+ digits)');
                return;
            }
            
            // Create order number
            const orderNumber = 'HS' + Date.now().toString().slice(-8);
            
            // Format date nicely
            const deliveryDate = new Date(date).toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Get time window text
            const timeText = {
                '9-12': '9:00 AM - 12:00 PM',
                '12-3': '12:00 PM - 3:00 PM',
                '3-6': '3:00 PM - 6:00 PM',
                '6-9': '6:00 PM - 9:00 PM'
            }[time];
            
            // Create the IMPORTANT payment-first message
            const message = 
                'üö® ====== PAYMENT REQUIRED FIRST ====== üö®\n\n' +
                
                'üìã YOUR ORDER DETAILS:\n' +
                'Order #: ' + orderNumber + '\n' +
                'Name: ' + name + '\n' +
                'Phone: ' + phone + '\n\n' +
                
                'üõí ORDER ITEMS:\n' +
                cart.map(item => '‚Ä¢ ' + item.name + ' - $' + item.price).join('\n') + '\n\n' +
                
                'üí∞ TOTAL TO PAY: $' + total + '\n\n' +
                
                'üìç DELIVERY INFORMATION:\n' +
                'Address: ' + address + '\n' +
                'Date: ' + deliveryDate + '\n' +
                'Time: ' + timeText + '\n' +
                (notes ? 'Notes: ' + notes + '\n' : '') + '\n' +
                
                'üí≥ ====== PAYMENT INSTRUCTIONS ======\n' +
                'CHOOSE ONE METHOD BELOW:\n\n' +
                
                'OPTION 1 - MPESA:\n' +
                '1. Go to MPesa Menu\n' +
                '2. Select "Send Money"\n' +
                '3. Enter: 0708592532\n' +
                '4. Amount: $' + total + '\n' +
                '5. Reference: ' + orderNumber + '\n\n' +
                
                'OPTION 2 - AIRTEL MONEY:\n' +
                '1. Go to Airtel Money Menu\n' +
                '2. Select "Send Money"\n' +
                '3. Enter: 0789503762\n' +
                '4. Amount: $' + total + '\n' +
                '5. Reference: ' + orderNumber + '\n\n' +
                
                'OPTION 3 - PAYPAL:\n' +
                '1. Send to: paypal.me/homestockexpress\n' +
                '2. Amount: $' + total + '\n' +
                '3. Note: Order ' + orderNumber + '\n\n' +
                
                'üì± ====== AFTER PAYMENT ======\n' +
                '1. Send WhatsApp screenshot to: +254708592532\n' +
                '2. We will confirm payment within 15 minutes\n' +
                '3. We will SMS you confirmation\n' +
                '4. Your order will be prepared\n' +
                '5. Delivery on ' + deliveryDate + ' (' + timeText + ')\n' +
                '6. Driver will call 30 minutes before arrival\n\n' +
                
                'üö´ IMPORTANT:\n' +
                '‚Ä¢ NO PAYMENT = NO DELIVERY\n' +
                '‚Ä¢ Delivery only after payment confirmation\n' +
                '‚Ä¢ All sales are FINAL - no returns\n\n' +
                
                'üìû CONTACT US:\n' +
                'Call/Text: 0708592532\n' +
                'WhatsApp: +254708592532\n' +
                'Email: deliverwhisk@gmail.com';
            
            // Show message
            alert(message);
            
            // Clear the cart
            localStorage.removeItem('cart');
            localStorage.removeItem('total');
            
            // Show success message
            alert('‚úÖ Order submitted successfully!\n\nYour order number is: ' + orderNumber + '\n\nPlease complete payment using the instructions shown.\n\nYou will be redirected to home page in 10 seconds.');
            
            // Redirect to home after 10 seconds
            setTimeout(function() {
                window.location.href = 'index.html';
            }, 10000);
        }
    </script>
</body>
</html>